# Dotfiles with Home Manager

Fully declarative dotfiles using Nix Home Manager. No more manual file management!

## Why Home Manager?

Instead of managing individual `.zshrc`, `.vimrc`, etc. files, Home Manager:
- **Generates** all dotfiles from Nix configurations
- **Installs** all your tools and dependencies
- **Manages** everything declaratively
- **Syncs** perfectly across all machines

## Quick Start

```bash
# Clone the repo
git clone https://github.com/yourusername/dotfiles.git ~/dotfiles
cd ~/dotfiles/home-manager

# Install (handles everything automatically)
./install.sh
```

That's it! Home Manager will generate and manage all your dotfiles.

## What Gets Managed

Home Manager **generates** these files for you:
- `~/.zshrc` - From `modules/zsh.nix`
- `~/.bashrc` - From shell aliases in `home.nix`
- `~/.vimrc` - From `modules/vim.nix`
- `~/.gitconfig` - From `modules/git.nix`
- `~/.tmux.conf` - From tmux settings in `home.nix`

**You never edit these files directly!** Edit the Nix modules instead.

## Structure

```
home-manager/
├── flake.nix           # Flake with all inputs
├── home.nix            # Main configuration
├── modules/
│   ├── zsh.nix        # Zsh config → generates ~/.zshrc
│   ├── vim.nix        # Vim config → generates ~/.vimrc
│   └── git.nix        # Git config → generates ~/.gitconfig
└── functions/
    └── ai-functions.zsh # Complex shell functions
```

## Making Changes

### Wrong Way ❌
```bash
vim ~/.zshrc  # Don't do this! Changes will be overwritten
```

### Right Way ✅
```bash
vim ~/dotfiles/home-manager/modules/zsh.nix  # Edit the source
home-manager switch --flake ~/dotfiles/home-manager#$USER@macbook  # Apply
```

## Example: Adding an Alias

Instead of adding to `.zshrc`:
```bash
# OLD WAY - Don't do this
echo 'alias foo="bar"' >> ~/.zshrc
```

Add to `modules/zsh.nix`:
```nix
# NEW WAY - Do this
shellAliases = {
  foo = "bar";
};
```

Then rebuild:
```bash
rebuild  # Alias provided after first install
```

## Benefits

1. **No manual file copying** - Everything is generated
2. **Atomic updates** - All changes succeed or rollback together
3. **Version control** - Track changes in git, easy rollbacks
4. **Reproducible** - Exact same setup on every machine
5. **Tool management** - Installs all CLI tools automatically

## FAQ

### Where are my actual dotfiles?
Home Manager generates them in your home directory. You can see them:
```bash
ls -la ~/.zshrc   # Generated by Home Manager
ls -la ~/.vimrc   # Generated by Home Manager
```

### Can I still edit ~/.zshrc directly?
You can, but **changes will be lost** next time you run `home-manager switch`. Always edit the Nix modules instead.

### What if I want simple dotfiles without Nix?
Check out the `legacy-dotfiles` branch for traditional dotfile management. But honestly, Home Manager is worth learning!

### How do I uninstall?
```bash
# Home Manager creates backups when installing
ls ~/.dotfiles-backup-*  # Your original files are here

# To completely remove
rm -rf ~/.config/home-manager
# Then restore your backups
```

## Resources

- [Home Manager Manual](https://nix-community.github.io/home-manager/)
- [Search for Nix packages](https://search.nixos.org)
- [Home Manager Options](https://nix-community.github.io/home-manager/options.html)